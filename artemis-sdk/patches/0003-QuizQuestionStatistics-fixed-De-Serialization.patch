From 3b6ae5fe737430773a12b6b9a4f466af837359e7 Mon Sep 17 00:00:00 2001
From: Ludwig Pusl <ludwig.pusl@tum.de>
Date: Fri, 31 Mar 2023 14:42:55 +0200
Subject: [PATCH] QuizQuestionStatistics fixed De/Serialization

---
 .../sdk/model/DragAndDropQuestionStatistic.java      | 11 +----------
 .../sdk/model/MultipleChoiceQuestionStatistic.java   | 12 +-----------
 .../ase/artemis/sdk/model/QuizQuestionStatistic.java |  9 +++------
 .../sdk/model/ShortAnswerQuestionStatistic.java      | 11 +----------
 4 files changed, 6 insertions(+), 37 deletions(-)

diff --git a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/DragAndDropQuestionStatistic.java b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/DragAndDropQuestionStatistic.java
index 8408da7..94e9da2 100644
--- a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/DragAndDropQuestionStatistic.java
+++ b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/DragAndDropQuestionStatistic.java
@@ -47,13 +47,4 @@ import de.tum.cit.ase.artemis.sdk.JSON;
-@JsonIgnoreProperties(
-  value = "type", // ignore manually set type, it will be automatically generated by Jackson during serialization
-  allowSetters = true // allows the type to be set during deserialization
-)
-@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type", visible = true)
-@JsonSubTypes({
-  @JsonSubTypes.Type(value = DragAndDropQuestionStatistic.class, name = "DD"),
-  @JsonSubTypes.Type(value = MultipleChoiceQuestionStatistic.class, name = "MC"),
-  @JsonSubTypes.Type(value = ShortAnswerQuestionStatistic.class, name = "SA"),
-})
+@JsonTypeName("drag-and-drop")
 
 public class DragAndDropQuestionStatistic extends QuizQuestionStatistic {
   public static final String JSON_PROPERTY_DROP_LOCATION_COUNTERS = "dropLocationCounters";
diff --git a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/MultipleChoiceQuestionStatistic.java b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/MultipleChoiceQuestionStatistic.java
index 8aac0f0..ffba777 100644
--- a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/MultipleChoiceQuestionStatistic.java
+++ b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/MultipleChoiceQuestionStatistic.java
@@ -47,14 +47,4 @@ import de.tum.cit.ase.artemis.sdk.JSON;
-@JsonIgnoreProperties(
-  value = "type", // ignore manually set type, it will be automatically generated by Jackson during serialization
-  allowSetters = true // allows the type to be set during deserialization
-)
-@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type", visible = true)
-@JsonSubTypes({
-  @JsonSubTypes.Type(value = DragAndDropQuestionStatistic.class, name = "DD"),
-  @JsonSubTypes.Type(value = MultipleChoiceQuestionStatistic.class, name = "MC"),
-  @JsonSubTypes.Type(value = ShortAnswerQuestionStatistic.class, name = "SA"),
-})
-
+@JsonTypeName("multiple-choice")
 public class MultipleChoiceQuestionStatistic extends QuizQuestionStatistic {
   public static final String JSON_PROPERTY_ANSWER_COUNTERS = "answerCounters";
   private Set<AnswerCounter> answerCounters = new LinkedHashSet<>();
diff --git a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/QuizQuestionStatistic.java b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/QuizQuestionStatistic.java
index 3cdd262..0118f3d 100644
--- a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/QuizQuestionStatistic.java
+++ b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/QuizQuestionStatistic.java
@@ -50,12 +50,9 @@ import de.tum.cit.ase.artemis.sdk.JSON;
 )
 @JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type", visible = true)
 @JsonSubTypes({
-  @JsonSubTypes.Type(value = DragAndDropQuestionStatistic.class, name = "DD"),
-  @JsonSubTypes.Type(value = DragAndDropQuestionStatistic.class, name = "DragAndDropQuestionStatistic"),
-  @JsonSubTypes.Type(value = MultipleChoiceQuestionStatistic.class, name = "MC"),
-  @JsonSubTypes.Type(value = MultipleChoiceQuestionStatistic.class, name = "MultipleChoiceQuestionStatistic"),
-  @JsonSubTypes.Type(value = ShortAnswerQuestionStatistic.class, name = "SA"),
-  @JsonSubTypes.Type(value = ShortAnswerQuestionStatistic.class, name = "ShortAnswerQuestionStatistic"),
+  @JsonSubTypes.Type(value = DragAndDropQuestionStatistic.class, name = "drag-and-drop"),
+  @JsonSubTypes.Type(value = MultipleChoiceQuestionStatistic.class, name = "multiple-choice"),
+  @JsonSubTypes.Type(value = ShortAnswerQuestionStatistic.class, name = "short-answer"),
 })
 
 public class QuizQuestionStatistic {
diff --git a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/ShortAnswerQuestionStatistic.java b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/ShortAnswerQuestionStatistic.java
index d577fa1..04a6bf0 100644
--- a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/ShortAnswerQuestionStatistic.java
+++ b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/ShortAnswerQuestionStatistic.java
@@ -47,13 +47,4 @@ import de.tum.cit.ase.artemis.sdk.JSON;
-@JsonIgnoreProperties(
-  value = "type", // ignore manually set type, it will be automatically generated by Jackson during serialization
-  allowSetters = true // allows the type to be set during deserialization
-)
-@JsonTypeInfo(use = JsonTypeInfo.Id.NAME, include = JsonTypeInfo.As.PROPERTY, property = "type", visible = true)
-@JsonSubTypes({
-  @JsonSubTypes.Type(value = DragAndDropQuestionStatistic.class, name = "DD"),
-  @JsonSubTypes.Type(value = MultipleChoiceQuestionStatistic.class, name = "MC"),
-  @JsonSubTypes.Type(value = ShortAnswerQuestionStatistic.class, name = "SA"),
-})
+@JsonTypeName("multiple-choice")
 
 public class ShortAnswerQuestionStatistic extends QuizQuestionStatistic {
   public static final String JSON_PROPERTY_SHORT_ANSWER_SPOT_COUNTERS = "shortAnswerSpotCounters";
-- 
2.34.1

