From 90617063b7aa0439f848151db334c82f7b3ad1aa Mon Sep 17 00:00:00 2001
From: Ludwig Pusl <ludwig.pusl@tum.de>
Date: Mon, 27 Mar 2023 18:02:06 +0200
Subject: [PATCH] patched sdk files to make it build and some configs

---
 artemis-sdk/pom.xml                           |  1 -
 .../de/tum/cit/ase/artemis/sdk/ApiClient.java | 51 +++++++++++--------
 .../sdk/model/ModelingPlagiarismResult.java   | 12 ++---
 .../cit/ase/artemis/sdk/model/Submission.java | 12 ++---
 4 files changed, 42 insertions(+), 34 deletions(-)

diff --git a/artemis-sdk/pom.xml b/artemis-sdk/pom.xml
index 2f3dfad..99d9d29 100644
--- a/artemis-sdk/pom.xml
+++ b/artemis-sdk/pom.xml
@@ -311,7 +311,6 @@
             <groupId>jakarta.annotation</groupId>
             <artifactId>jakarta.annotation-api</artifactId>
             <version>${jakarta-annotation-version}</version>
-            <scope>provided</scope>
         </dependency>
         <dependency>
             <groupId>org.glassfish.jersey.connectors</groupId>
diff --git a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/ApiClient.java b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/ApiClient.java
index fcc7a26..fc0e87e 100644
--- a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/ApiClient.java
+++ b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/ApiClient.java
@@ -154,7 +154,7 @@ public class ApiClient extends JavaTimeFormatter {
    * <p>Setter for the field <code>httpClient</code>.</p>
    *
    * @param httpClient a {@link jakarta.ws.rs.client.Client} object.
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setHttpClient(Client httpClient) {
     this.httpClient = httpClient;
@@ -174,7 +174,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Sets the base URL to the location where the OpenAPI document is being served.
    *
    * @param basePath The base URL to the target host.
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setBasePath(String basePath) {
     this.basePath = basePath;
@@ -194,7 +194,7 @@ public class ApiClient extends JavaTimeFormatter {
    * <p>Setter for the field <code>servers</code>.</p>
    *
    * @param servers a {@link java.util.List} of servers.
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setServers(List<ServerConfiguration> servers) {
     this.servers = servers;
@@ -215,7 +215,7 @@ public class ApiClient extends JavaTimeFormatter {
    * <p>Setter for the field <code>serverIndex</code>.</p>
    *
    * @param serverIndex the server index
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setServerIndex(Integer serverIndex) {
     this.serverIndex = serverIndex;
@@ -236,7 +236,7 @@ public class ApiClient extends JavaTimeFormatter {
    * <p>Setter for the field <code>serverVariables</code>.</p>
    *
    * @param serverVariables a {@link java.util.Map} of server variables.
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setServerVariables(Map<String, String> serverVariables) {
     this.serverVariables = serverVariables;
@@ -273,7 +273,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Helper method to set username for the first HTTP basic authentication.
    *
    * @param username Username
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setUsername(String username) {
     for (Authentication auth : authentications.values()) {
@@ -289,7 +289,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Helper method to set password for the first HTTP basic authentication.
    *
    * @param password Password
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setPassword(String password) {
     for (Authentication auth : authentications.values()) {
@@ -305,7 +305,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Helper method to set API key value for the first API key authentication.
    *
    * @param apiKey API key
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setApiKey(String apiKey) {
     for (Authentication auth : authentications.values()) {
@@ -321,7 +321,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Helper method to configure authentications which respects aliases of API keys.
    *
    * @param secrets Hash map from authentication name to its secret.
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient configureApiKeys(Map<String, String> secrets) {
     for (Map.Entry<String, Authentication> authEntry : authentications.entrySet()) {
@@ -343,7 +343,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Helper method to set API key prefix for the first API key authentication.
    *
    * @param apiKeyPrefix API key prefix
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setApiKeyPrefix(String apiKeyPrefix) {
     for (Authentication auth : authentications.values()) {
@@ -359,7 +359,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Helper method to set bearer token for the first Bearer authentication.
    *
    * @param bearerToken Bearer token
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setBearerToken(String bearerToken) {
     for (Authentication auth : authentications.values()) {
@@ -375,7 +375,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Set the User-Agent header's value (by adding to the default header map).
    *
    * @param userAgent Http user agent
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setUserAgent(String userAgent) {
     this.userAgent = userAgent;
@@ -397,7 +397,7 @@ public class ApiClient extends JavaTimeFormatter {
    *
    * @param key The header's key
    * @param value The header's value
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient addDefaultHeader(String key, String value) {
     defaultHeaderMap.put(key, value);
@@ -409,7 +409,7 @@ public class ApiClient extends JavaTimeFormatter {
    *
    * @param key The cookie's key
    * @param value The cookie's value
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient addDefaultCookie(String key, String value) {
     defaultCookieMap.put(key, value);
@@ -429,7 +429,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Set the client config.
    *
    * @param clientConfig Set the client config
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setClientConfig(ClientConfig clientConfig) {
     this.clientConfig = clientConfig;
@@ -451,7 +451,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Enable/disable debugging for this API client.
    *
    * @param debugging To enable (true) or disable (false) debugging
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setDebugging(boolean debugging) {
     this.debugging = debugging;
@@ -475,7 +475,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Set temp folder path
    *
    * @param tempFolderPath Temp folder path
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setTempFolderPath(String tempFolderPath) {
     this.tempFolderPath = tempFolderPath;
@@ -497,7 +497,7 @@ public class ApiClient extends JavaTimeFormatter {
    * {@link Integer#MAX_VALUE}.
    *
    * @param connectionTimeout Connection timeout in milliseconds
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setConnectTimeout(int connectionTimeout) {
     this.connectionTimeout = connectionTimeout;
@@ -520,7 +520,7 @@ public class ApiClient extends JavaTimeFormatter {
    * {@link Integer#MAX_VALUE}.
    *
    * @param readTimeout Read timeout in milliseconds
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setReadTimeout(int readTimeout) {
     this.readTimeout = readTimeout;
@@ -541,7 +541,7 @@ public class ApiClient extends JavaTimeFormatter {
    * Set the date format used to parse/format date parameters.
    *
    * @param dateFormat Date format
-   * @return a {@link org.openapitools.client.ApiClient} object.
+   * @return a {@link de.tum.cit.ase.artemis.sdk.ApiClient} object.
    */
   public ApiClient setDateFormat(DateFormat dateFormat) {
     this.dateFormat = dateFormat;
@@ -757,7 +757,8 @@ public class ApiClient extends JavaTimeFormatter {
           multiPart.bodyPart(new FormDataBodyPart(contentDisp, file, MediaType.APPLICATION_OCTET_STREAM_TYPE));
         } else {
           FormDataContentDisposition contentDisp = FormDataContentDisposition.name(param.getKey()).build();
-          multiPart.bodyPart(new FormDataBodyPart(contentDisp, parameterToString(param.getValue())));
+          //TODO: check if a condition is necessary if object -> JSON else just pass a String?
+          multiPart.bodyPart(new FormDataBodyPart(contentDisp, param.getValue(), MediaType.APPLICATION_JSON_TYPE));
         }
       }
       entity = Entity.entity(multiPart, MediaType.MULTIPART_FORM_DATA_TYPE);
@@ -1142,6 +1143,14 @@ public class ApiClient extends JavaTimeFormatter {
    */
   protected void customizeClientBuilder(ClientBuilder clientBuilder) {
     // No-op extension point
+    try {
+      // TODO: make this configurable via command argument in artemis-zeus?!
+      disableCertificateValidation(clientBuilder);
+    } catch (KeyManagementException e) {
+      throw new RuntimeException(e);
+    } catch (NoSuchAlgorithmException e) {
+      throw new RuntimeException(e);
+    }
   }
 
   /**
diff --git a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/ModelingPlagiarismResult.java b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/ModelingPlagiarismResult.java
index 2d72521..1ecd9bb 100644
--- a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/ModelingPlagiarismResult.java
+++ b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/ModelingPlagiarismResult.java
@@ -27,7 +27,7 @@ import com.fasterxml.jackson.annotation.JsonTypeName;
 import com.fasterxml.jackson.annotation.JsonValue;
 import com.fasterxml.jackson.databind.annotation.JsonDeserialize;
 import de.tum.cit.ase.artemis.sdk.model.Exercise;
-import de.tum.cit.ase.artemis.sdk.model.PlagiarismComparisonModelingSubmissionElement;
+import de.tum.cit.ase.artemis.sdk.model.PlagiarismComparisonObject;
 import de.tum.cit.ase.artemis.sdk.model.PlagiarismResultObject;
 import java.time.OffsetDateTime;
 import java.util.ArrayList;
@@ -53,17 +53,17 @@ import de.tum.cit.ase.artemis.sdk.JSON;
 
 public class ModelingPlagiarismResult extends PlagiarismResultObject {
   public static final String JSON_PROPERTY_COMPARISONS = "comparisons";
-  private Set<PlagiarismComparisonModelingSubmissionElement> comparisons = new LinkedHashSet<>();
+  private Set<PlagiarismComparisonObject> comparisons = new LinkedHashSet<>();
 
   public ModelingPlagiarismResult() { 
   }
 
-  public ModelingPlagiarismResult comparisons(Set<PlagiarismComparisonModelingSubmissionElement> comparisons) {
+  public ModelingPlagiarismResult comparisons(Set<PlagiarismComparisonObject> comparisons) {
     this.comparisons = comparisons;
     return this;
   }
 
-  public ModelingPlagiarismResult addComparisonsItem(PlagiarismComparisonModelingSubmissionElement comparisonsItem) {
+  public ModelingPlagiarismResult addComparisonsItem(PlagiarismComparisonObject comparisonsItem) {
     if (this.comparisons == null) {
       this.comparisons = new LinkedHashSet<>();
     }
@@ -79,7 +79,7 @@ public class ModelingPlagiarismResult extends PlagiarismResultObject {
   @JsonProperty(JSON_PROPERTY_COMPARISONS)
   @JsonInclude(value = JsonInclude.Include.USE_DEFAULTS)
 
-  public Set<PlagiarismComparisonModelingSubmissionElement> getComparisons() {
+  public Set<PlagiarismComparisonObject> getComparisons() {
     return comparisons;
   }
 
@@ -87,7 +87,7 @@ public class ModelingPlagiarismResult extends PlagiarismResultObject {
   @JsonDeserialize(as = LinkedHashSet.class)
   @JsonProperty(JSON_PROPERTY_COMPARISONS)
   @JsonInclude(value = JsonInclude.Include.USE_DEFAULTS)
-  public void setComparisons(Set<PlagiarismComparisonModelingSubmissionElement> comparisons) {
+  public void setComparisons(Set<PlagiarismComparisonObject> comparisons) {
     this.comparisons = comparisons;
   }
 
diff --git a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/Submission.java b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/Submission.java
index ddbf3bc..f3b66c0 100644
--- a/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/Submission.java
+++ b/artemis-sdk/src/main/java/de/tum/cit/ase/artemis/sdk/model/Submission.java
@@ -25,7 +25,7 @@ import com.fasterxml.jackson.annotation.JsonSubTypes;
 import com.fasterxml.jackson.annotation.JsonTypeInfo;
 import com.fasterxml.jackson.annotation.JsonTypeName;
 import com.fasterxml.jackson.annotation.JsonValue;
-import de.tum.cit.ase.artemis.sdk.model.CleanupBuildPlan200Response;
+import de.tum.cit.ase.artemis.sdk.model.Participation;
 import de.tum.cit.ase.artemis.sdk.model.FileUploadSubmission;
 import de.tum.cit.ase.artemis.sdk.model.ModelingSubmission;
 import de.tum.cit.ase.artemis.sdk.model.ProgrammingSubmission;
@@ -127,7 +127,7 @@ public class Submission {
   private Boolean exampleSubmission;
 
   public static final String JSON_PROPERTY_PARTICIPATION = "participation";
-  private CleanupBuildPlan200Response participation;
+  private Participation participation;
 
   public static final String JSON_PROPERTY_SUBMISSION_DATE = "submissionDate";
   private OffsetDateTime submissionDate;
@@ -136,7 +136,7 @@ public class Submission {
   private Boolean empty;
 
   public static final String JSON_PROPERTY_DURATION_IN_MINUTES = "durationInMinutes";
-  private Long durationInMinutes;
+  Long durationInMinutes;
 
   public static final String JSON_PROPERTY_RESULTS = "results";
   private List<Result> results = new ArrayList<>();
@@ -257,7 +257,7 @@ public class Submission {
   }
 
 
-  public Submission participation(CleanupBuildPlan200Response participation) {
+  public Submission participation(Participation participation) {
     this.participation = participation;
     return this;
   }
@@ -270,14 +270,14 @@ public class Submission {
   @JsonProperty(JSON_PROPERTY_PARTICIPATION)
   @JsonInclude(value = JsonInclude.Include.USE_DEFAULTS)
 
-  public CleanupBuildPlan200Response getParticipation() {
+  public Participation getParticipation() {
     return participation;
   }
 
 
   @JsonProperty(JSON_PROPERTY_PARTICIPATION)
   @JsonInclude(value = JsonInclude.Include.USE_DEFAULTS)
-  public void setParticipation(CleanupBuildPlan200Response participation) {
+  public void setParticipation(Participation participation) {
     this.participation = participation;
   }
 
-- 
2.34.1

